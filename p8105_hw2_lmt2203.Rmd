---
title: "Homework_2"
author: "Linh Tran"
date: "9/24/2020"
output: github_document
---

```{r setup}
library(tidyverse)
library(readxl)
library(dplyr)
```

## Problem 1

Read the Mr. Trashwheel dataset.

```{r}
trashwheel_df = 
  read_xlsx("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
            sheet = "Mr. Trash Wheel",
            range = cell_cols("A:N")) %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(
    sports_balls = round(sports_balls),
    sports_balls = as.integer(sports_balls)
  )
```

Read precipitation data

```{r}
precip_2018 = 
  read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
             sheet = "2018 Precipitation",
             skip = 1
  ) %>% 
  janitor::clean_names() %>% 
  drop_na(month) %>% 
  mutate(year = 2018) %>% 
  relocate(year)

precip_2017 = 
  read_excel("./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
             sheet = "2017 Precipitation",
             skip = 1
  ) %>% 
  janitor::clean_names() %>% 
  drop_na(month) %>% 
  mutate(year = 2017) %>% 
  relocate(year)
```

Now combine annual precipitation.

```{r}
month_df = 
  tibble(
    month = 1:12,
    month_name = month.name
  )
precip_df = 
  bind_rows(precip_2018, precip_2017) 

left_join(precip_df, month_df, by = "month")
```

This dataset contains information from the Mr.Trashwheel trash collector in Baltimore, Maryland. As trash enters the inner harbor, the trashwheel collects that trash, and stores it in a dumpster. The dataset contains information on year, month, and trash collected, include some specific kinds of trash. There are a total of `r nrow(trashwheel_df)` rows in our final dataset. Additional data sheets include month precpitation data. 

## Problem 2



```{r import and clean data, message = FALSE, warning = FALSE}
#This code chunk is to read and clean the data

nyc_transit = read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, station_longitude, route1:route11, entry, vending, entrance_type, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE)) %>% 
  mutate_at(vars(route8:route11), as.character)
```

This dataset contains *`r names(nyc_transit)`* variables. The dataset has dimensions of **`r nrow(nyc_transit)`** rows and **`r ncol(nyc_transit)`** columns. I imported the dataset, changed the variable names to snake cases, select the variables of interest and converted the entry variable from character to logical variable. This data is not yet tidy because route name is spread across multiple columns. 

* To answer questions about the NYC transit data:
  + There are **`r nrow(nyc_transit %>% distinct(line, station_name))`** distinct stations. 
  + The number of stations that are ADA complaint is **`r nrow(nyc_transit %>% distinct(line, station_name, ada) %>% filter(ada == "TRUE"))`**.
  + The proportion of station entrances/exits without vending allow entrance is **`r (nrow(nyc_transit %>% filter(entry == "TRUE" & vending == "NO"))/nrow(nyc_transit %>% filter(vending == "NO")))*100`**


```{r reformat route number and route name}
#This code chunk reformats data so that route number and route name are distinct variables

nyc_transit_long = nyc_transit %>% 
  pivot_longer(route1:route11,
               names_to = "route_name",
               names_prefix = "route",
               values_to = "route_number")
```

* To answer questions about the A train:
  + The number of distinct stations serve the A train is **`r nrow(nyc_transit_long %>% distinct(line, station_name, route_number) %>% filter(route_number == "A"))`**.
  + Of the stations that serve the A train, there are **`r nrow(nyc_transit_long %>% distinct(line, station_name, route_number, ada) %>% filter(route_number == "A", ada == "TRUE" ))`** stations that are ADA complaint. 


## Problem 3

